<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>NS_RestrictContactActivation</fullName>
    <active>true</active>
    <description>This validation rule will restrict changing the status of an Inactive contact for other users.</description>
    <errorConditionFormula>AND(TEXT(PRIORVALUE(NS_ContactStatus__c)) = &#39;Inactive&#39;,
ISCHANGED(NS_ContactStatus__c),
OR(TEXT(NS_ContactStatus__c) = &#39;Active&#39;,
TEXT(NS_ContactStatus__c) = &#39;Request Deactivation&#39;
),
NOT(OR($Profile.Name = &#39;OSS Support&#39;,
$Profile.Name = &#39;System Administrator&#39;
)),
NOT(AND($Profile.Name = &#39;NS Integration User&#39;,
RecordType.DeveloperName = &#39;NS_Driver&#39;
))
)</errorConditionFormula>
    <errorDisplayField>NS_ContactStatus__c</errorDisplayField>
    <errorMessage>Inactive Contact cannot be activated.</errorMessage>
</ValidationRule>
